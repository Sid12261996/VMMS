@model VMMAPI.Models.VMMOBJ

@{
    ViewBag.Title = "";
    Layout = null;
}

@{
    var usertype= TempData.Peek("UserType");
}



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>In Progress VMM Portal</title>

    <!-- Bootstrap css-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <!--Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!--Google Font-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700" rel="stylesheet">

    <!-- Propeller css -->
    <link href="../VmmAssets/css/propeller.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/buttons/1.5.4/css/buttons.dataTables.min.css" rel="stylesheet">

    <!-- Propeller date time picker css-->
    <link rel="stylesheet" type="text/css" href="../components/datetimepicker/css/bootstrap-datetimepicker.css" />
    <link rel="stylesheet" type="text/css" href="../components/datetimepicker/css/pmd-datetimepicker.css" />





    <!-- Custom css -->
    <link href="../VmmAssets/css/style.css" rel="stylesheet">
    <link href="../VmmAssets/css/responsive.css" rel="stylesheet">
    <link href="../VmmAssets/css/propeller.min.css" rel="stylesheet" />


    <!-- Select2 css-->
    <link rel="stylesheet" type="text/css" href="../components/select2/css/select2.min.css" />
    <link rel="stylesheet" type="text/css" href="../components/select2/css/select2-bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../components/select2/css/pmd-select2.css" />
</head>

<body>
    <header>
        <nav class="navbar navbar-fixed-top pmd-navbar pmd-z-depth">
            <div class="container-fluid">
                <input type="hidden" id="taskidhidden" />
                <input type="hidden" id="AssetsIdHidden" />
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button class="pmd-ripple-effect navbar-toggle pmd-navbar-toggle" type="button">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="javascript:void(0);" class="navbar-brand navbar-brand-custome">
                        <img src="~/VmmAssets/images/team_blue_logo.svg" alt="team blue logo"><span class="logo-txt">Project Governance</span>
                    </a>
                </div>
                <!-- Collect the nav links, forms, and other content for toggling -->
                <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse pmd-navbar-sidebar">
                    <div class="dropdown pmd-dropdown pmd-user-info pull-right">
                        <a href="javascript:void(0);" class="btn-user dropdown-toggle media" data-toggle="dropdown" data-sidebar="true" aria-expanded="false">
                            <div class="media-left">

                                @using (Html.BeginForm("Logout", "VMMAssign", FormMethod.Post))
                                {
                                    <!-- form goes here -->



                                    <input type="submit" value="" class="logout-icon" />


                                }
                            </div>

                        </a>

                    </div>
                    <ul class="nav navbar-nav">
                        <li>
                            <a class="pmd-ripple-effect " href="@Url.Action("AssignTaskNew1", "VMMAssign")" ;">
                                <i class="material-icons">
                                    add
                                </i> <span>Assign New</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect active" href="@Url.Action("ShowTransactionDetails", "VMMAssign")" ;">
                                <span>In Progress</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect" href="@Url.Action("ViewSummaryReport", "VMMAssign")" ;">
                                <span>Summary</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect" href="@Url.Action("ViewDashBoardReport", "VMMAssign")" ;">
                                <span>Detailed Report</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect" href="@Url.Action("AddIE", "IE")" ;">
                                <span>IE</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect" href="#" ;">
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect" href="#" ;">
                                <span>Customer Report</span>
                            </a>
                        </li>
                        <li>
                            <a class="pmd-ripple-effect" href="#" ;">
                                <span>Engineer Report</span>
                            </a>
                        </li>
                    </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
            <div class="pmd-sidebar-overlay"></div>
        </nav>
        <!-- Nav menu with user information -->

    </header>
    <section class="sel-dat top-m in-pro">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-5">
                    <div class="form-group pmd-textfield">
                        <div class="sta-hdr">
                            <label><img src="~/VmmAssets/images/list_icon.svg" alt="list icon"> <span>Showing all assigned calls</span></label>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </section>
    <section class="res-box inp">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-4">
                    <div class="form-group pmd-textfield ">
                        <label for="regular1" class="control-label">Start Date</label>
                        <input type="text" id="datepicker-start" class="form-control" />
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="form-group pmd-textfield ">
                        <label for="regular1" class="control-label">End Date</label>
                        <input type="text" id="datepicker-end" class="form-control" />
                    </div>
                </div>


                <div class="col-md-4">
                    <div class="form-group pmd-textfield">
                        <label><img src="~/VmmAssets/images/user_icon.svg" alt="user icon"> <span>Customer Name</span></label>

                        @Html.DropDownList("ddlCustName", new List<SelectListItem>
               {


               }, "SELECT ", new { @class = "select-with-search form-control pmd-select2" })

                    </div>
                </div>

            </div>
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group pmd-textfield">
                        <label><img src="~/VmmAssets/images/location_icon.svg" alt="location icon"> <span>City</span></label>

                        @Html.DropDownList("ddlCity", new List<SelectListItem>
               {


               }, "SELECT ", new { @class = "select-with-search form-control pmd-select2" })

                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group pmd-textfield">
                        <label for="regular1" class="control-label"> <img src="~/VmmAssets/images/location_icon.svg" alt="location icon"> <span>State</span></label>
                        <input type="text" id="txtstate" class="form-control" />


                    </div>
                </div>

                <div class="col-md-4">

                    <!--Linked pickers example -->

                    <div class="row">

                        <div class="col-sm-6">
                            <div class="form-group pmd-textfield">
                                <input type="button" id="clickButton" name="SubmitButton" class="btn pmd-btn-raised pmd-ripple-effect btn-success" value="Submit" />

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <!-- Hoverable table -->
                        <div class="pmd-card pmd-z-depth">
                            <div class="table-normal table-responsive" id="PnLlnProgress">

                            </div>
                        </div>





                    </div>
                </div>
            </div>
</section>

    <!-- jQuery before Propeller.js -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js">
    </script>


    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/buttons/1.5.4/js/dataTables.buttons.min.js"></script>

    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/buttons/1.5.4/js/buttons.flash.min.js"></script>

    <script type="text/javascript" language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

    <script type="text/javascript" language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>


    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/buttons/1.5.4/js/buttons.html5.min.js"></script>

    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/buttons/1.5.4/js/buttons.print.min.js"></script>



    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../VmmAssets/js/propeller.min.js"></script>
    <script type="text/javascript" src="../VmmAssets/js/jquery.nicescroll.min.js"></script>

    <!-- Datatable select js-->
    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/select/1.2.0/js/dataTables.select.min.js"></script>
    <!-- Select2 js-->
    <script type="text/javascript" src="../components/select2/js/select2.full.js"></script>
    <script type="text/javascript" src="../components/select2/js/pmd-select2.js"></script>



    <script>
        $(".do-nicescroll3").niceScroll();
        $(document).ready(function () {
            $(".pmd-switch input").change(function () {
                if ($(this).is(":checked")) {
                    $(this).val("sre");
                }
                else {
                    $(this).val("sqe");
                }
            });
        })
    </script>

    <script type="text/javascript">


        //Disable Back Button In All Browsers.
        function DisableBackButtonAllBrowsers() {
            window.history.forward()
        };
        DisableBackButtonAllBrowsers();
        window.onload = DisableBackButtonAllBrowsers;
        window.onpageshow = function (evts) { if (evts.persisted) DisableBackButtonAllBrowsers(); };
        window.onunload = function () { void (0) };
    </script>

    <script type="text/javascript">
          function LoadCustomer() {


            var url = '@Url.Action("LoadCustomer", "VMMAssign")';


        
            $.getJSON(url, function (result) {
                var data = result;
                $("#ddlCustName").empty();

                $("#ddlCustName").append('<option selected="selected"  ></option>');
                $.each(eval(data.replace(/[\r\n]/, "")), function (i, item) {

                    $("#ddlCustName").append($('<option/>', { value: item.CustId, text: item.CustName }));

                });
            });
        }


          function LoadCity() {


            var url = '@Url.Action("LoadCity", "VMMAssign")';

            $.getJSON(url, function (result) {
                var data = result;
                $("#ddlCity").empty();
                $("#ddlCity").append('<option selected="selected"  ></option>');
                $.each(eval(data.replace(/[\r\n]/, "")), function (i, item) {

                    $("#ddlCity").append($('<option/>', { value: item.City, text: item.City }));

                });
            });
        }


        $(document).ready(function () {

            LoadCustomer();

            LoadCity();

                $(".select-with-search").select2({
            theme: "bootstrap"
        });


            $("#clickButton").click(function () {
              var startDate = $("#datepicker-start").val();
                    var EndDate = $("#datepicker-end").val();
                    var State = $('#txtstate').val();
                    var city =$('#ddlCity option:selected').val();
                    var CustomerName=$('#ddlCustName option:selected').val();
                LoadTransaction(startDate, EndDate,city,CustomerName,State);

            });



        });

          function LoadTransaction(startDate, EndDate,City,CustomerName,State ) {

            $.ajax({
                type: "POST",

                url: "/VMMAssign/ShowTransactionDetailsGet",

                data: { StartDate: startDate, EndDate: EndDate,City:City,CustomerName:CustomerName,State:State },
                async: false,
                dataType: "json",
                success: function (data) {


                $("#PnLlnProgress").empty();
                var table = $('#tblShowTransaction').DataTable();
                table.destroy();

                var tempTable =  "<table id='tblShowTransaction' width='100%' Class='table pmd-table tblShowTransactionc'><thead> <tr>"
                tempTable +=  "<th>SR.No</th>"
                if (@usertype == 1) {
                    tempTable += "<th> Customer Name</th >"
                }
                tempTable += "<th>Task Category</th><th>City</th><th>NoOfAssets</th>"
                if (@usertype == 1) {
                    tempTable += "<th>Assigned To</th>"
                }
                tempTable +=  "<th>AssignDate</th > <th>Action</th><th></th></tr></thead>";




                $.each(eval(data.replace(/[\r\n]/, "")), function (i, item) {
                 
                    tempTable += "<tr >";

                    tempTable += "<td style='width:250px'>" + item.TransactionNo + "<input id='HiddenVendorId' type='hidden' name='HiddenVendorId'  value=" + item.TransactionNo + " /></td>";
                    if (@usertype == 1)
                    {
                        tempTable += "<td style='width:250px'>" + item.CustName + "</td>";
                    }
                    tempTable += "<td style='width:250px'>" + item.Type + "</td>";
                    tempTable += "<td style='width:250px'>" + item.City + "</td>";
                    tempTable += "<td style='width:250px' >" + item.NoOfAssest +"  <input type='text' name='txtAssets' id='txtAssets'  value=" + item.NoOfAssest + " style='display: none;' /> </td>";

                   if (@usertype == 1)
                   {
                        tempTable += "<td style='width:250px'>" + item.Name + "</td>";
                    }
                    tempTable += "<td style='width:250px'>" + item.AssignDate + "</td>";

                      var Base64 = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function (e) { var t = ""; var n, r, i, s, o, u, a; var f = 0; e = Base64._utf8_encode(e); while (f < e.length) { n = e.charCodeAt(f++); r = e.charCodeAt(f++); i = e.charCodeAt(f++); s = n >> 2; o = (n & 3) << 4 | r >> 4; u = (r & 15) << 2 | i >> 6; a = i & 63; if (isNaN(r)) { u = a = 64 } else if (isNaN(i)) { a = 64 } t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a) } return t }, decode: function (e) { var t = ""; var n, r, i; var s, o, u, a; var f = 0; e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); while (f < e.length) { s = this._keyStr.indexOf(e.charAt(f++)); o = this._keyStr.indexOf(e.charAt(f++)); u = this._keyStr.indexOf(e.charAt(f++)); a = this._keyStr.indexOf(e.charAt(f++)); n = s << 2 | o >> 4; r = (o & 15) << 4 | u >> 2; i = (u & 3) << 6 | a; t = t + String.fromCharCode(n); if (u != 64) { t = t + String.fromCharCode(r) } if (a != 64) { t = t + String.fromCharCode(i) } } t = Base64._utf8_decode(t); return t }, _utf8_encode: function (e) { e = e.replace(/\r\n/g, "\n"); var t = ""; for (var n = 0; n < e.length; n++) { var r = e.charCodeAt(n); if (r < 128) { t += String.fromCharCode(r) } else if (r > 127 && r < 2048) { t += String.fromCharCode(r >> 6 | 192); t += String.fromCharCode(r & 63 | 128) } else { t += String.fromCharCode(r >> 12 | 224); t += String.fromCharCode(r >> 6 & 63 | 128); t += String.fromCharCode(r & 63 | 128) } } return t }, _utf8_decode: function (e) { var t = ""; var n = 0; var r = c1 = c2 = 0; while (n < e.length) { r = e.charCodeAt(n); if (r < 128) { t += String.fromCharCode(r); n++ } else if (r > 191 && r < 224) { c2 = e.charCodeAt(n + 1); t += String.fromCharCode((r & 31) << 6 | c2 & 63); n += 2 } else { c2 = e.charCodeAt(n + 1); c3 = e.charCodeAt(n + 2); t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63); n += 3 } } return t } }
                    var url = '@Url.Action("ShowTransactionExpandView", "VMMAssign")';
                    var ProjectNoId = Base64.encode(item.TransactionNo);
                    var url_com = url + "?TRNO=" + ProjectNoId;
                    tempTable += "<td style='width:250px'><a href='" + url_com + "' class='green-btn'>See Details</a></td>";

                    tempTable += "";
                    tempTable += "</tr>";
                });

                tempTable += "</tbody>";
                tempTable += "</table>";



                $("#PnLlnProgress").append(tempTable);


                $('#tblShowTransaction').DataTable({
                    "pageLength": 5,
                    responsive: true,
                    dom: 'Bfrtip',
                    buttons: [
                        'csv', 'excel', 'pdf', 'print'
                    ]
                });



                }




            });




        }





    </script>
    <script type="text/javascript" language="javascript" src="../components/datetimepicker/js/moment-with-locales.js"></script>
    <script type="text/javascript" language="javascript" src="../components/datetimepicker/js/bootstrap-datetimepicker.js"></script>
    <script>
        // Default date and time picker
        $('#datetimepicker-default').datetimepicker();

        // View mode datepicker [shows only years and month]
        $('#datepicker-view-mode').datetimepicker({
            viewMode: 'years',
            format: 'MM/YYYY'
        });

        // Inline datepicker
        $('#datepicker-inline').datetimepicker({
            inline: true
        });

        // Time picker only
        $('#timepicker').datetimepicker({
            format: 'LT'
        });

        // Linked date and time picker
        // start date date and time picker
        $('#datepicker-start').datetimepicker({

            'format': "DD-MM-YYYY", // HH:mm:ss}

        });

        // End date date and time picker
        $('#datepicker-end').datetimepicker({
            useCurrent: false,
            'format': "DD-MM-YYYY",  // HH:mm:ss}
        });

        // start date picke on chagne event [select minimun date for end date datepicker]
        $("#datepicker-start").on("dp.change", function (e) {
            $('#datepicker-end').data("DateTimePicker").minDate(e.date);
        });
        // Start date picke on chagne event [select maxmimum date for start date datepicker]
        $("#datepicker-end").on("dp.change", function (e) {
            $('#datepicker-start').data("DateTimePicker").maxDate(e.date);
        });

        // Disabled Days of the Week (Disable sunday and saturday) [ 0-Sunday, 1-Monday, 2-Tuesday   3-wednesday 4-Thusday 5-Friday 6-Saturday]
        $('#datepicker-disabled-days').datetimepicker({
            daysOfWeekDisabled: [0, 6]
        });

        // Datepicker in popup
        $('#datepicker-popup-inline').datetimepicker({
            inline: true
        });

        $("[data-header-left='true']").parent().addClass("pmd-navbar-left");



        // Datepicker left header
        $('#datepicker-left-header').datetimepicker({
            'format': "YYYY-MM-DD", // HH:mm:ss
        });
        function abc(d) {
            alert(d);
        }
    </script>

</body>
</html>